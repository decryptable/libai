"use strict";var f=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var O=Object.prototype.hasOwnProperty;var C=(e,t)=>{for(var n in t)f(e,n,{get:t[n],enumerable:!0})},U=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of D(t))!O.call(e,i)&&i!==n&&f(e,i,{get:()=>t[i],enumerable:!(r=A(t,i))||r.enumerable});return e};var M=e=>U(f({},"__esModule",{value:!0}),e);var K={};C(K,{default:()=>_});module.exports=M(K);var a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function y(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}var v=require("crypto"),u=new Uint8Array(256),d=u.length;function c(){return d>u.length-16&&((0,v.randomFillSync)(u),d=0),u.slice(d,d+=16)}var g={};function P(e,t,n){let r;if(e)r=w(e.random??e.rng?.()??c(),e.msecs,e.seq,t,n);else{let i=Date.now(),o=c();j(g,i,o),r=w(o,g.msecs,g.seq,t,n)}return t??y(r)}function j(e,t,n){return e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],e.msecs=t):(e.seq=e.seq+1|0,e.seq===0&&e.msecs++),e}function w(e,t,n,r,i=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(!r)r=new Uint8Array(16),i=0;else if(i<0||i+16>r.length)throw new RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`);return t??=Date.now(),n??=e[6]*127<<24|e[7]<<16|e[8]<<8|e[9],r[i++]=t/1099511627776&255,r[i++]=t/4294967296&255,r[i++]=t/16777216&255,r[i++]=t/65536&255,r[i++]=t/256&255,r[i++]=t&255,r[i++]=112|n>>>28&15,r[i++]=n>>>20&255,r[i++]=128|n>>>14&63,r[i++]=n>>>6&255,r[i++]=n<<2&255|e[10]&3,r[i++]=e[11],r[i++]=e[12],r[i++]=e[13],r[i++]=e[14],r[i++]=e[15],r}var p=P;var E=async()=>{try{return(await(await fetch("https://saas.castbox.fm/auth/api/v1/tokens/provider/secret",{headers:{"x-app-id":"ai-seek","content-type":"application/json"},body:JSON.stringify({secret:p()}),method:"POST"})).json()).data.token}catch(e){return console.error(e),null}},R=E;var x=class extends TransformStream{#e="";constructor(t={allowCR:!1}){super({transform:(n,r)=>{for(n=this.#e+n;;){let i=n.indexOf(`
`),o=t.allowCR?n.indexOf("\r"):-1;if(o!==-1&&o!==n.length-1&&(i===-1||i-1>o)){r.enqueue(n.slice(0,o)),n=n.slice(o+1);continue}if(i===-1)break;let l=n[i-1]==="\r"?i-1:i;r.enqueue(n.slice(0,l)),n=n.slice(i+1)}this.#e=n},flush:n=>{if(this.#e==="")return;let r=t.allowCR&&this.#e.endsWith("\r")?this.#e.slice(0,-1):this.#e;n.enqueue(r)}})}};function k(e){let t=new TextDecoderStream,n=new x({allowCR:!0});return e.pipeThrough(t).pipeThrough(n)}function T(e){let n=/[:]\s*/.exec(e),r=n&&n.index;if(r)return[e.substring(0,r),e.substring(r+n[0].length)]}function h(e,t,n){e.get(t)||e.set(t,n)}async function*N(e,t){if(!e.body)return;let n=k(e.body),r,i=n.getReader(),o;for(;;){if(t&&t.aborted)return i.cancel();if(r=await i.read(),r.done)return;if(!r.value){o&&(yield o),o=void 0;continue}let[l,s]=T(r.value)||[];l&&(l==="data"?(o||={},o[l]=o[l]?o[l]+`
`+s:s):l==="event"?(o||={},o[l]=s):l==="id"?(o||={},o[l]=+s||s):l==="retry"&&(o||={},o[l]=+s||void 0))}}async function S(e,t){let n=new Request(e,t);h(n.headers,"Accept","text/event-stream"),h(n.headers,"Content-Type","application/json");let r=await fetch(n);if(!r.ok)throw r;return N(r,n.signal)}var V=async(e,t,n,r,i,o)=>{try{let l=await S("https://ai-seek.thebetter.ai/v3/chat/send",{headers:{"X-App-Id":"ai-seek","X-Access-Token":t,"content-type":"application/json"},body:JSON.stringify({sessionId:i??p(),model:n??"deepseek/deepseek-r1",text:e,restrictedType:"PRO_USER",imageS3Keys:null,fileS3Keys:null,webSearch:r}),method:"POST"}),s;for await(let q of l)try{let m=JSON.parse(q.data);o&&o(m),s+=m.content}catch{}return s}catch{return null}},I=V;var X=async()=>{try{return(await(await fetch("https://ai-seek.thebetter.ai/v1/chat/list_models",{headers:{"X-App-Id":"ai-seek"}})).json()).data.models}catch{return null}},b=X;var J={generateAuthToken:R,getChatResponse:I,getModels:b},_=J;
